#------------------------------
# DIRECTORIES
#------------------------------

#------------------------------
# IMPORTS
#------------------------------

Import('env')
Import('type')

#------------------------------
# DEPENDENCIES
#------------------------------

components = ['error','memory','monitor', 'parallel', 'field', 'cello']
libraries  = ['png']

#------------------------------
# ENVIRONMENTS
#------------------------------

env = env.Clone(LIBS=[components,libraries])

#------------------------------
# SOURCE
#------------------------------

includes = [Glob('mesh*hpp')]
sources  = [Glob('mesh*cpp')]
sources_tree = [Glob('mesh*Node*cpp'), Glob('mesh*Tree*cpp')]

#------------------------------
# TARGETS
#------------------------------

libraries = env.Library ('mesh', [sources])

test_mesh  = env.Program (['test_Mesh.cpp',  sources])
test_patch = env.Program (['test_Patch.cpp', sources])
test_block = env.Program (['test_Block.cpp', sources])
test_tree  = env.Program (['test_TreeK.cpp', sources_tree])

if (type == "charm"):
   env.Depends('test_Mesh.o',  '../Test/test.decl.h')
   env.Depends('test_Patch.o', '../Test/test.decl.h')
   env.Depends('test_Block.o', '../Test/test.decl.h')
   env.Depends('test_TreeK.o', '../Test/test.decl.h')

binaries = [test_mesh, test_patch, test_block, test_tree ];

#------------------------------
# INSTALL
#------------------------------

env.Alias('install-inc',env.Install ('#/include',includes))
env.Alias('install-lib',env.Install ('#/lib',    libraries))
env.Alias('install-bin',env.Install ('#/bin',    binaries))
env.Alias('install-bin',env.Install ('#/bin-'+type,binaries))
